#****************************************************************************************************************************************************************************************************************************************************************
# Nombre: Inicio.Py                                                                                                                                                                                                                                             *
# Descripcion:  Consta de un simple programita que realizara el inicio de la aplicación. Muestra botones para poder ejecutar el Script correspondiente al buscador o al diario del programa. Presenta el Nombre del usuario de Windows utilziando y muestra una *
#               barra de progreso que se utiliza como ejemplar para mostrar una carga de datos.                                                                                                                                                                 *
#****************************************************************************************************************************************************************************************************************************************************************
import os as os
import sys as sys
from sys import *
from os import replace, system as system
import datetime,time
#****************************************************************************************************************************************************************************************************************************************************************
import tkinter as tk
from tkinter import *
from tkinter import Entry, Grid, Image, StringVar, Text, Variable, messagebox, ttk, scrolledtext, simpledialog, tix, font, commondialog
from tkinter.ttk import Progressbar, setup_master,Sizegrip,Entry
from tkinter.tix import STATUS, LabelEntry,LabelFrame,Meter, ButtonBox,PhotoImage,ComboBox
from tkinter.constants import *
#****************************************************************************************************************************************************************************************************************************************************************
import openpyxl
from openpyxl import Workbook,load_workbook
from Variables import *
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************
#                                                                                                               Declaración de Variables                                                                                                                        *
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************
# Defina Interfaz Grafica Principal                                                                                                                                                                                                                             *
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************
myapp = Tk()                                                                                                                        # MyApp es el nombre de la planilla a visualizar                                                                            *                                                                                                             
myapp.title("Iniciador")                                                                                                            # Defino el titulo del programa                                                                                             *
myapp.minsize(600,350)
myapp.maxsize(600,350)                                                                                                              # Defino el Tamaño minimo e inicial de plantilla                                                                            *
myapp.resizable(False,False)
myapp.config(background=Fondo)                                                                                                      # Defino color de Fondo de pantalla "Myapp"                                                                                 *
#****************************************************************************************************************************************************************************************************************************************************************

#****************************************************************************************************************************************************************************************************************************************************************                     
# Definimos los Progress Bar y el texto que se muestra al final de la misma                                                                                                                                                                                     *
#****************************************************************************************************************************************************************************************************************************************************************
s = ttk.Style()                                                                                                                     # Definimos el nombre del "Tipo de Style" para poder definir el estilo a utilizar en el progress bar                        *
s.theme_use('clam') 
s.configure("red.Horizontal.TProgressbar", foreground='red', background='red')                                                      # Configuramos los parametros de colores tanto del Fondo como de la barra de prorgeso cuando requiere marcar                *    

pb = ttk.Progressbar(myapp,orient = HORIZONTAL,length = 540, mode = 'determinate',style="red.Horizontal.TProgressbar")              # Creamos el Progresbar para mostrar el progeso del proceso de creación de planilla                                         *
pb.place(x=5, y=320)                                                                                                                # Configuramos la posición del progressbar                                                                                  *
#****************************************************************************************************************************************************************************************************************************************************************
txt = Label(myapp,text = '0%',bg = '#345',fg = '#fff')                                                                              # Configuramos el Texto que muestra el porsentaje del progressbar                                                           *
txt.place(x=550 ,y=320 )                                                                                                            # Se configura la posición                                                                                                  *
#****************************************************************************************************************************************************************************************************************************************************************
myimg       =PhotoImage     (file=(user + "/Desktop/Soft/Toyota-Logo.png"))                                                         # Seleccionamos la imagen a mostrar en el incio del programa. Esta imagen puede ser modificada solo requiero reemplazar ruta*
lbl_lable   =ttk.Label      (myapp,image=myimg,border=0,background=Fondo).place(x=10,y=10)                                          # Configuramos la posición de la imagen pero definimos como el "Label"                                                      *
usr_lbl     =ttk.Label      (myapp,justify='left',text="Bienvenido "+new_user[9:],font=("Old English Text MT",25),background=Fondo).place(x=10, y=200)
                                                                                                                                    # Definimos la tipografia, tamañno y posición del lable a utilizar                                                          *
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************

#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************
# Definiciones de Sub Procesos                                                                                                                                                                                                                                  *
#****************************************************************************************************************************************************************************************************************************************************************
def Barra():                                                                                                                        # Progress bar de inicio
    myapp.update()                                                                                                                  # Rutina donde se modifica la barra de progreso, para contar el tiempo para abrir la siguiente pantalla                     *
    pb['value'] += 5                                                                                                                # Modificamos el valor del "Progress bar" aumentando de a 5                                                                 *
    time.sleep(.2)                                                                                                                  # Tiempo de Espera entre aumentos de Progress                                                                               *
    txt['text']=pb['value'],'%'                                                                                                     # Mostramos el valor del Progress en porcentaje, solo en modo visual                                                        *
#****************************************************************************************************************************************************************************************************************************************************************
def Buscar():                                                                                                                       # Seleccionamos para abrir el Buscador                                                                                      *
    global dato
    Inicio()                                                                                                                        # Se ejecuta "Inicio" para modificar el valor del progress bar                                                              *
    dato="Buscador"                                                                                                                 # Configuramos la variable Dato para registrar en el Log
    close()                                                                                                                         # Se cierra la ventana inicial                                                                                              *
    import buscador                                                                                                                 # Importamos "Buscador.py"                                                                                                  *
#****************************************************************************************************************************************************************************************************************************************************************    
def Diario():                                                                                                                       # Seleccionamos para abrir el Diario                                                                                        *
    global dato
    Inicio()                                                                                                                        # Se ejecuta "Inicio" para modificar el valor del progress bar                                                              *
    dato="Diario"                                                                                                                   # Configuramos la variable Dato para registrar en el Log
    close()                                                                                                                         # Se cierra la ventana inicial                                                                                              *
    import diario                                                                                                                   # Importamos "diario.py"                                                                                                    *
#****************************************************************************************************************************************************************************************************************************************************************
def Inicio():                                                                                                                       # Proceso del Progress bar para darle un poco de aletoriedad                                                                *   
    Barra()                                                                                                                         # pb=5                                                                                                                      *
    pb['value']+=1                                                                                                                  # pb=6                                                                                                                      *
    Barra()                                                                                                                         # pb=11                                                                                                                     *
    pb['value']+=1                                                                                                                  # pb=12                                                                                                                     *
    Barra()                                                                                                                         # pb=17                                                                                                                     *
    pb['value']+=4                                                                                                                  # pb=21                                                                                                                     *
    Barra()                                                                                                                         # pb=26                                                                                                                     *
    pb['value']+=5                                                                                                                  # pb=31                                                                                                                     *
    Barra()                                                                                                                         # pb=36                                                                                                                     *
    Barra()                                                                                                                         # pb=41                                                                                                                     *
    pb['value']+=5                                                                                                                  # pb=46                                                                                                                     *
    Barra()                                                                                                                         # pb=51                                                                                                                     *
    pb['value']+=4                                                                                                                  # pb=55                                                                                                                     *
    Barra()                                                                                                                         # pb=60                                                                                                                     *
    pb['value']+=5                                                                                                                  # pb=65                                                                                                                     *
    Barra()                                                                                                                         # pb=70                                                                                                                     *
    pb['value']+=5                                                                                                                  # pb=75                                                                                                                     *
    Barra()                                                                                                                         # pb=80                                                                                                                     *
    Barra()                                                                                                                         # pb=85                                                                                                                     *
    pb['value']+=10                                                                                                                 # pb=95                                                                                                                     *
    Barra()                                                                                                                         # pb=100                                                                                                                    *
    return                                                                                                                                                                                                                                                     #*
#****************************************************************************************************************************************************************************************************************************************************************
def close():
    Mensaje=(" => Inicio => "+user[9:30] + " Selecciona " +str(dato)+". Se ejecuta scrip y se cierra Inicio \n")
    import WLog
    myapp.destroy()
#****************************************************************************************************************************************************************************************************************************************************************
#****************************************************************************************************************************************************************************************************************************************************************                     
# Definimos botones para iniciar sub programas                                                                                                                                                                                                                  *
#****************************************************************************************************************************************************************************************************************************************************************
boton=  tk.Button(myapp,text="Buscador" ,activebackground="#ABCDEF" ,background="#838B8B"   ,command=Buscar ,width=25   ,state="active")    .place(x=400,y=60)   # Definimos el Boton para ejecutar el "Buscador.py"                                            *
diario= tk.Button(myapp,text="Diario"   ,activebackground="#ABCDEF" ,background="#838B8B"   ,command=Diario ,width=25   ,state="active")    .place(x=400,y=90)     # Definimos el Boton para ejecutar el "diario.py"                                            *
#****************************************************************************************************************************************************************************************************************************************************************

#****************************************************************************************************************************************************************************************************************************************************************
myapp.mainloop()
#****************************************************************************************************************************************************************************************************************************************************************